\documentclass{book}
  \usepackage[text={15cm,25cm},centering]{geometry} 
  \usepackage[english,spanish,es-tabla]{babel}
  \usepackage[latin1]{inputenc}
  
%--Dise�o de la tabla de contenido   
\usepackage{xcolor}
\usepackage{framed}

\definecolor{myred}{RGB}{12,13,12}
\definecolor{myyellow}{RGB}{166,206,58}

\renewenvironment{leftbar}{%
  \def\FrameCommand{{\color{myyellow}\vrule width 2pt depth 6pt} \hspace{10pt}}%
  \MakeFramed {\advance\hsize-\width \FrameRestore}}%
 {\endMakeFramed}
\makeatletter
\def\@chapter[#1]#2{\ifnum \c@secnumdepth >\m@ne
                       \if@mainmatter
                         \refstepcounter{chapter}%
                         \typeout{\@chapapp\space\thechapter.}%
                         \addtocontents{toc}%
                                   {%
                                       {\protect\parbox{3.5em}{\hfill\Huge\color{myred}\bfseries\thepage}}%
                                         \protect\hspace*{.5em}
                                        \protect\parbox{\dimexpr\linewidth-4em\relax}{%
                                           \protect\begin{leftbar}
                                              {\scshape\small\chaptername~\thechapter}\\\sffamily#1%
                                           \protect\end{leftbar}}\par\noindent
                                    }%
                       \else
                         \addcontentsline{toc}{chapter}{#1}%
                       \fi
                    \else
                      \addcontentsline{toc}{chapter}{#1}%
                    \fi
                    \chaptermark{#1}%
                    \addtocontents{lof}{\protect\addvspace{10\p@}}%
                    \addtocontents{lot}{\protect\addvspace{10\p@}}%
                    \if@twocolumn
                      \@topnewpage[\@makechapterhead{#2}]%
                    \else
                      \@makechapterhead{#2}%
                      \@afterheading
                    \fi}
\makeatother

\begin{document}

\tableofcontents
\tableofcontents
\chapter{(T�tulo  cap�tulo 1)}

\section{(T�tulo  Secci�n1)}
\subsection{(T�tulo  sub-Secci�n1)}
\subsection{(T�tulo  sub-Secci�n2)}
\section{(T�tulo  Secci�n2)}
\subsection{(T�tulo  sub-Secci�n1)}
\subsection{(T�tulo  sub-Secci�n2)}

\chapter{(T�tulo  Cap�tulo 2)}

\section{(T�tulo  Secci�n1)}
\subsection{(T�tulo  sub-Secci�n1)}
\subsection{(T�tulo  sub-Secci�n2)}
\section{(T�tulo  Secci�n2)}
\subsection{(T�tulo  sub-Secci�n1)}
\subsection{( sub-Secci�n2)}
\end{document} 